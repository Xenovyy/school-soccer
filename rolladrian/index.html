<!DOCTYPE html><html><head><title>Roll Adrian </title><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui=1"><meta charset="UTF-8"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="description" content=""><link rel="manifest" href="manifest.json"><link rel="icon" type="image/png" href="icon64.png"><link rel="apple-touch-icon" sizes="180x180" href="icon180.png"><link rel="icon" type="image/png" sizes="32x32" href="icon32.png"><link rel="icon" type="image/png" sizes="16x16" href="icon16.png"><style>html,body {
  margin: 0;
  padding: 0;
  background-color: #000;
  overflow:hidden;
  font-family: Verdana;
}
.noselect {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
#canvaswrapper {
  text-align: center ;
}
</style><style>@font-face { font-family: "BitCell" ; src: url("fonts/BitCell.ttf") format("truetype"); }</style><script>window.fonts = ["BitCell"]</script></head><body class="noselect custom-cursor" oncontextmenu="return false;"><div id="canvaswrapper"></div><script type="text/javascript">var resources = {"images":[{"file":"cookie.png","version":5,"size":575,"properties":{"frames":1,"fps":5}},{"file":"icon.png","version":0,"size":0,"properties":{}}],"assets":[],"maps":{},"sounds":[],"music":[]};
var graphics = "M1";

</script><script type="text/javascript">var orientation = 'any' ;
var aspect = 'free' ;
var ms_libs = ["matterjs_v019"] ;
window.skip_service_worker = true;
window.exported_project = true;
window.ms_use_server = false ;
</script><script src="matter.min.js"></script><script src="runner.js"></script><script src="fengari-web.js"></script><script src="microengine.js"></script></body><script type="text/javascript">//
//
// The game is started with the code below.
// Once you have received the "started" signal (see below),
// you can do the following:
// 1) Inject functions or objects into the global context of the microStudio engine, example:
//
//   window.player.setGlobal("special_callback",function(x) { console.info(x) }) ;
//   // Your microScript code can now call the "special_callback" function
//
// 2) Call microScript global functions from your JavaScript code, example:
//
//   window.player.call("call_me_from_javascript",[10,1000]) ;
//   // arguments to the function call are provided as an array
//
// 3) Run a microScript code snippet from your JavaScript code, example:
//
//   window.player.exec("player.position_x = 50",function(result) { console.log(result) ; }) ;
//

window.addEventListener("load",function() {
  window.player = new Player(function(event) {
    if (event.name == "started") {
      // signal that the game is started
    }
    else if (event.name == "log") {
      // console.info(event.data) ;
    }
  }) ;
  document.body.focus() ;
}) ;

</script><script id="code" type="text/x-microscript">

cube = {}
cubedrawlist = {}
index = 0
function cube:new(px,py,sx,sy,rot,isstatic)
  
  cube[index]=Matter.Bodies:rectangle(px,py,sx,sy)
  Matter.Composite:add(engine.world,cube[index])
  if isstatic == true then
    Matter.Body:setStatic(cube[index], true)
  end
  --Matter.Body:setAngle(cube[index], rot)
  cubedrawlist[index]={x=sx,y=sy}
  --cubedrawlist[index].px = cube[index].position.x
  --cubedrawlist[index].py = cube[index].position.y
  --cubedrawlist[index].sx = sx
  --cubedrawlist[index].sy = sy
  --cubedrawlist[index].rot = cube[index].angle/math.pi*180

  index = index + 1
end

init = function()
  print("init")
  engine = Matter.Engine:create()
  engine.world.gravity.y = -1
  cookie = Matter.Bodies:circle(0,0,10)
  ground = Matter.Bodies:rectangle(0,-50,20000,10)
  Matter.Composite:add(engine.world,ground)
  softbody = Matter.Composites:softBody(0, 50, 5, 5, 1, 1, 1, 5)
  Matter.Composite:add(engine.world,softbody)
  Matter.Composite:add(engine.world,cookie)
  Matter.Body:setStatic(ground, true)
  ball = Matter.Bodies:circle(0,50,20)
  ball.friction = .5
  ballsize=20
  ground.friction = .5
  Matter.Composite:add(engine.world,ball)
  cameraX = 0
  cameraY = 0
  cookieX=0
  cookieY=0
  jumpcooldown = 0
  screenscaleX=1
  movedelay=0
  test=0
  screenscaleY=1
  function distance ( x1, y1, x2, y2 )
  local dx = x1 - x2
  local dy = y1 - y2
  return math.sqrt ( dx * dx + dy * dy )
end
oldmouseposy=0
end

update = function()
  
  Matter.Engine:update(engine,1000/60)
  ballX = ball.position.x
  ballY = ball.position.y
  cookieX = cookie.position.x
  cookieY = cookie.position.y
  jumpcooldown = jumpcooldown+1
  if mouse.pressed == 1 and Matter.Body:getSpeed(ball)<10 then
    movedelay = movedelay+1
    cube:new(mouse.x-cameraX,mouse.y-cameraY,10,10,0,false)
    if mouse.y-oldmouseposy > 1 and jumpcooldown>60 and movedelay > 1 then
      jumpcooldown=-1000
      Matter.Body:applyForce(ball,ball.position,Matter.Vector:create(0,0.05))
    end
    if mouse.x>0 then 
      Matter.Body:applyForce(ball,ball.position,Matter.Vector:create(.0025,0))
      else
        Matter.Body:applyForce(ball,ball.position,Matter.Vector:create(-.0025,0))
    end
    else
      movedelay=0
  end
  --camera
  cameraX = (cameraX + ((cameraX-ballX)/2))/2
  cameraY = (cameraY + ((cameraY-ballY)/2))/2-10
  --cookie detection
  --print(distance(ballX,ballY,cookieX,cookieY))
  test=test+1
  if distance(ballX,ballY,cookieX,cookieY)<ballsize+10 and test>60 then
    test = 0
    --Matter.Body:setPosition(ball, Matter.Vector:create(0,0))
    ballsize = ballsize*1.5
    Matter.Body:scale(ball,1.5, 1.5)
  end
  oldmouseposy = mouse.y
  --print(softbody.position.y)
end

draw = function()
  screen:clear()
  screen:setTranslation(cameraX*screenscaleX,cameraY*screenscaleY)
  screen:setScale(screenscaleX,screenscaleY)
  if index > 0 then
  for i = 0,index-1,1 do
    screen:setDrawRotation(cube[i].angle/math.pi*180)
    screen:fillRect(cube[i].position.x,cube[i].position.y,cubedrawlist[i].x,cubedrawlist[i].y)
    screen:setDrawRotation(0)
  end
  end
  screen:drawRect(ground.position.x,ground.position.y,20000,10,"rgb(255,0,0)")
  screen:setDrawRotation(ball.angle/math.pi*180)
  screen:drawRound(ball.position.x,ball.position.y,ballsize*2,ballsize*2,"#FF0")
  screen:drawRect(ballX,ballY,1,ballsize*2)
  screen:setDrawRotation(cookie.angle/math.pi*180)
  --screen:drawRound(cookie.position.x,cookie.position.y,20,20)
  screen:drawSprite( "cookie", cookieX, cookieY, 16, 16 )
  screen:setDrawRotation(0)
end

</script></html>